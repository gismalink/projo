# Спецификация продукта (MVP)

## 1. Назначение
`Projo Planner` — инструмент для годового планирования проектов и загрузки команды с минимальным входом, быстрым стартом и прозрачной структурой данных.

## 1.1 Термины и уровни агрегации
- **План** — контейнер верхнего уровня на экране «Мои планы» (технически: project space / workspace).
- **Проект** — сущность внутри плана, которая участвует в таймлайне, assignment и расчетах нагрузки.
- На стартовом экране пользователь оперирует планами (карточками планов), а не проектами таймлайна.

## 2. Пользовательская ценность
- Быстрое создание и визуализация плана по проектам и сотрудникам.
- Гибкое управление ролями, отделами, грейдами и отпускными периодами.
- Настройка шаблонов состава проекта и контроль недостающих ролей в таймлайне.
- Визуальный контроль загрузки и узких мест на годовом таймлайне.
- Единая точка для справочников и календарных ограничений.
- Единая команда сотрудников и настроек для нескольких планов одного владельца.

## 3. Границы MVP
- Только базовые CRUD-операции для справочников и планирования.
- Нет интеграций с внешними системами, сложных отчетов и timesheet-факта.
- Нет ML/прогнозирования, мультивалютности, multi-calendar.

## 4. Критерии приемки
1. Пользователь может войти (bootstrap-admin), создать/редактировать роли, отделы, сотрудников, проекты, назначения, отпуска.
2. Пользователь может создавать/редактировать шаблоны состава проекта и привязывать шаблон к проекту.
3. На Timeline отображаются ошибки по недостающим ролям относительно выбранного шаблона проекта.
4. Вкладки Team, Settings, Timeline, Guide работают по назначению (см. UI).
5. Визуально отображаются фильтры, группировки, загрузка, bench, drag/resize.
6. Все действия проходят через API с RBAC и валидацией.
7. Проект разворачивается и верифицируется по инструкции из README.

## 4.1 Правила планов (верхний уровень)
- Пользователь может иметь несколько планов (карточек на стартовом экране).
- Люди, грейды и ключевые справочники шарятся между планами одного владельца.
- Расчетные метрики нагрузки/часов считаются внутри активного плана и не суммируются автоматически между разными планами.
- Для карточки плана доступно действие «Копия» (tooltip: «Скопировать план»), которое создает копию с суффиксом `_v(x)`.
- На карточках планов могут отображаться KPI для сравнения планов между собой.

## 5. Правила модели участия в проекте
- В проекте различаются две сущности:
	- membership (`ProjectMember`) — сотрудник включен в состав проекта,
	- assignment (`ProjectAssignment`) — сотруднику назначен период работ и нагрузка.
- Допустимые состояния на текущем этапе:
	- только `member` (сотрудник в пуле без активного назначения),
	- `member + assignment` (сотрудник в пуле и участвует в плане),
	- удален из пула (`member` удален), при этом assignment может сохраняться до явной корректировки.
- Создание/обновление assignment должно гарантировать, что сотрудник присутствует в пуле проекта (если нужно, membership создается автоматически).
- Assignment может выходить за плановые даты проекта; это не блокируется сохранением и подсвечивается в Timeline как ошибка `fact-range`.
- Удаление assignment не должно автоматически удалять membership.
- Удаление membership не должно автоматически удалять assignment (поведение фиксируется как текущий контракт).
- При сдвиге дат проекта смещение assignment выполняется отдельным действием Timeline и не считается неявным побочным эффектом CRUD проекта.

## 6. Связанные документы
- API-методы и контракты: `docs/api-reference.md`
- Архитектура и технические детали: `docs/architecture-overview.md`
- План развития и приоритеты: `docs/implementation-roadmap.md`